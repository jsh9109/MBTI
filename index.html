<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MBTI æ·±åº¦äººæ ¼è¯´æ˜ä¹¦ - 2025 ç»ˆæç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ================= è§†è§‰ç³»ç»Ÿï¼šç„¦ç³–å¥¶æ²¹é£ ================= */
        :root {
            --primary: #8B5E3C;        /* ç„¦ç³–æ·±æ£• */
            --secondary: #D4A373;      /* æ‹¿é“é‡‘ */
            --accent: #BC6C25;         /* æ´»åŠ›æ©™æ£• */
            --bg-body: #FDFBF7;        /* å¥¶æ²¹ç™½èƒŒæ™¯ */
            --card-bg: #FFFFFF;        /* å¡ç‰‡ç™½ */
            --text-main: #4A403A;      /* æ·±ç°è¤ */
            --text-sub: #8D8178;       /* æµ…ç°è¤ */
            --red-price: #D00000;      /* ä»·æ ¼çº¢ */
            --shadow: 0 8px 24px rgba(139, 94, 60, 0.08);
            --radius: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            min-height: 100vh;
            background-image: radial-gradient(#E6DACE 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* é€šç”¨ç»„ä»¶ */
        .container { max-width: 640px; margin: 0 auto; padding: 0 0 80px 0; min-height: 100vh; position: relative; }
        .hidden { display: none !important; }
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin: 15px;
            padding: 20px;
            border: 1px solid rgba(212, 163, 115, 0.1);
        }
        .btn {
            display: block;
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(139, 94, 60, 0.3);
        }
        .btn-primary:active { transform: scale(0.98); }
        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            margin-top: 10px;
        }

        /* 1. é¦–é¡µ Landing */
        .hero { text-align: center; padding: 40px 20px; }
        .hero h1 { font-size: 28px; color: var(--primary); margin-bottom: 10px; font-weight: 800; letter-spacing: 1px; }
        .hero p { color: var(--text-sub); font-size: 14px; margin-bottom: 30px; }
        .hero-tags { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .tag { background: #F3EBE3; color: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .start-cover { width: 100%; border-radius: var(--radius); margin-bottom: 20px; display: block; background: #eee; min-height: 200px; object-fit: cover;}
        
        /* 2. ç­”é¢˜é¡µ Quiz */
        .progress-bar { height: 6px; background: #eee; margin-bottom: 20px; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--secondary); width: 0%; transition: width 0.3s; }
        .question-text { font-size: 18px; font-weight: bold; margin-bottom: 25px; min-height: 60px; }
        .option-item {
            background: #F8F4F0; padding: 15px; border-radius: 12px; margin-bottom: 12px;
            text-align: center; color: var(--text-main); font-weight: 500; transition: all 0.2s; border: 1px solid transparent;
        }
        .option-item.selected { background: var(--primary); color: #fff; border-color: var(--primary); }

        /* 3. ç»“æœé¡µï¼ˆå…è´¹/ä»˜è´¹å…±ç”¨æ¡†æ¶ï¼‰ */
        .result-header { text-align: center; padding: 30px 20px; background: linear-gradient(180deg, #FDFBF7 0%, #F5EFE6 100%); }
        .mbti-big { font-size: 48px; font-weight: 900; color: var(--primary); letter-spacing: 2px; margin: 10px 0; }
        .mbti-name { font-size: 20px; color: var(--accent); font-weight: bold; }
        .chart-box { position: relative; height: 300px; width: 100%; margin: 20px 0; }
        
        /* æ¨¡ç³Šé®ç½©ï¼ˆä»˜è´¹å¢™ï¼‰ */
        .blur-wall {
            position: relative;
            overflow: hidden;
        }
        .blur-content { filter: blur(8px); user-select: none; pointer-events: none; opacity: 0.6; }
        .lock-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 40%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10; padding: 20px;
        }
        
        /* æ”¯ä»˜å¡ç‰‡ */
        .pay-card {
            background: #fff; border: 2px solid var(--secondary); border-radius: var(--radius);
            padding: 20px; text-align: center; width: 100%; box-shadow: 0 10px 30px rgba(139,94,60,0.15);
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        
        .price-row { margin-bottom: 15px; }
        .old-price { text-decoration: line-through; color: #999; font-size: 14px; }
        .new-price { color: var(--red-price); font-size: 32px; font-weight: 800; margin-left: 5px; }
        .pay-desc { font-size: 12px; color: var(--text-sub); margin-bottom: 15px; }
        
        /* æ·±åº¦æŠ¥å‘Šæ ·å¼ */
        .report-section { margin-bottom: 25px; }
        .section-title { 
            font-size: 18px; color: var(--primary); font-weight: bold; 
            border-left: 4px solid var(--secondary); padding-left: 10px; margin-bottom: 15px; 
            background: rgba(212, 163, 115, 0.1); padding: 8px 10px; border-radius: 0 8px 8px 0;
        }
        .report-text { font-size: 15px; line-height: 1.8; text-align: justify; color: #555; }
        .highlight { color: var(--red-price); font-weight: bold; background: #FFF0F0; padding: 0 4px; }

        /* å¹¿å‘Šä½ */
        .ad-banner {
            background: linear-gradient(135deg, #333 0%, #555 100%);
            color: #FFD700; padding: 15px; border-radius: 12px;
            text-align: center; margin: 30px 15px; cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .ad-title { font-weight: bold; font-size: 16px; margin-bottom: 5px; }
        .ad-sub { font-size: 12px; opacity: 0.8; }

        /* æ”¯ä»˜å¼¹çª— */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 999; display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: #fff; width: 90%; max-width: 400px; border-radius: 20px; padding: 25px;
            text-align: center; position: relative;
        }
        .close-modal { position: absolute; top: 10px; right: 15px; font-size: 24px; color: #999; cursor: pointer; }
        .qr-img { width: 180px; height: 180px; margin: 15px auto; background: #f0f0f0; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px; }
        
        /* åº•éƒ¨ */
        .footer { text-align: center; padding: 30px 0; font-size: 12px; color: #ccc; }
    </style>
</head>
<body>

    <div class="container">
        
        <div id="page-home">
            <div class="hero">
                <div class="tag" style="margin-bottom:10px;">ğŸ”¥ 2025 å…¨ç½‘æœ€ç«äººæ ¼åˆ†æ</div>
                <h1>MBTI æ·±åº¦äººæ ¼è¯´æ˜ä¹¦</h1>
                <p>å‰¥ç¦»è¡¨è±¡ï¼Œç›´è§†ä½ æ½œæ„è¯†æ·±å¤„çš„æ¬²æœ›ä¸ææƒ§</p>
                
                <div class="card" style="padding: 10px; border:none; background:transparent; box-shadow:none;">
                    <div style="background: #EFEBE5; height: 180px; border-radius: 16px; display:flex; align-items:center; justify-content:center; color:#999; font-size:14px; border: 2px dashed #D4A373;">
                        æ­¤å¤„å»ºè®®æ”¾ç½®ä¸€å¼ å¯Œæœ‰è´¨æ„Ÿçš„å°é¢å›¾<br>(å»ºè®®æ¯”ä¾‹ 16:9)
                    </div>
                </div>

                <div class="hero-tags">
                    <span class="tag">ğŸ’¡ 60é“ä¸“ä¸šé‡è¡¨</span>
                    <span class="tag">ğŸ“Š 4ç»´æ·±åº¦è§£æ</span>
                    <span class="tag">ğŸ¯ 3000å­—æŠ¥å‘Š</span>
                </div>

                <div style="margin-bottom: 20px; text-align: left;">
                    <input type="text" id="legacy-card" placeholder="æˆ‘æœ‰æ—§ç‰ˆå¡å¯†ï¼ˆé€‰å¡«ï¼‰" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:8px; font-size:14px; background:#fff;">
                </div>

                <button class="btn btn-primary" onclick="startQuiz()">å¼€å§‹æ·±åº¦æ¢ç´¢</button>
                <div style="margin-top:10px; font-size:12px; color:#999;">å·²æœ‰ 1,283,492 äººå‚ä¸æµ‹è¯•</div>
            </div>
        </div>

        <div id="page-quiz" class="hidden" style="padding: 20px;">
            <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
            <div style="display:flex; justify-content:space-between; font-size:12px; color:#999; margin-bottom:10px;">
                <span id="q-index">1/60</span>
                <span>ç›´è§‰é€‰æ‹©ï¼Œä¸è¦çŠ¹è±«</span>
            </div>
            
            <div class="card">
                <div class="question-text" id="q-text">é¢˜ç›®åŠ è½½ä¸­...</div>
                <div id="options-box"></div>
            </div>
        </div>

        <div id="page-result" class="hidden">
            <div class="result-header">
                <div class="tag">æ‚¨çš„æ ¸å¿ƒäººæ ¼</div>
                <div class="mbti-big" id="res-type">INTJ</div>
                <div class="mbti-name" id="res-name">å»ºç­‘å¸ˆ</div>
                <p style="font-size:13px; color:#666; margin-top:10px;" id="res-desc">ç®€çŸ­æè¿°...</p>
            </div>

            <div class="card">
                <div class="section-title">ğŸ“Š äººæ ¼ç»´åº¦é›·è¾¾å›¾</div>
                <div class="chart-box">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>

            <div id="pay-wall">
                <div class="blur-wall">
                    <div class="blur-content">
                        <div class="card">
                            <div class="section-title">ğŸ§  æ½œæ„è¯†æ·±å±‚æ‹†è§£</div>
                            <p class="report-text">è¿™é‡Œæ˜¯å…³äºä½ æ½œæ„è¯†çš„æ·±åº¦åˆ†æï¼Œä½ å¯èƒ½ç»å¸¸æ„Ÿåˆ°...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰ã€‚ä½ çš„æ ¸å¿ƒé©±åŠ¨åŠ›æ¥æºäº...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰ã€‚åœ¨é¢å¯¹å‹åŠ›æ—¶ï¼Œä½ é€šå¸¸ä¼š...</p>
                        </div>
                        <div class="card">
                            <div class="section-title">ğŸ’° æé’±å¤©èµ‹ä¸çŸ­æ¿</div>
                            <p class="report-text">ä½ çš„è´¢å¯ŒåŸºå› ä¸»è¦é›†ä¸­åœ¨...ï¼ˆæ­¤å¤„å†…å®¹å·²éšè—ï¼‰ã€‚</p>
                        </div>
                    </div>
                    
                    <div class="lock-overlay">
                        <div class="pay-card">
                            <div style="font-size:18px; font-weight:bold; color:var(--primary); margin-bottom:5px;">è§£é” 3000å­— æ·±åº¦è¯´æ˜ä¹¦</div>
                            <div class="price-row">
                                <span class="old-price">åŸä»· Â¥29.9</span>
                                <span class="new-price">Â¥2.99</span>
                            </div>
                            <div class="pay-desc">å«ï¼šæ½œæ„è¯†è§£æ + æ‹çˆ±åŒ¹é… + æé’±æŒ‡å— + 30å¤©è¿›åŒ–è¡¨</div>
                            <button class="btn btn-primary" onclick="showPayModal()">ç«‹å³è§£é”å…¨éƒ¨å†…å®¹</button>
                            <button class="btn btn-outline" onclick="checkLegacyCard()">éªŒè¯å·²æœ‰å¡å¯†</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="paid-content" class="hidden">
                <div id="deep-report-container"></div>
                
                <div class="ad-banner" onclick="alert('è”ç³»ç®¡ç†å‘˜å¾®ä¿¡ï¼šAdmin123 å’¨è¯¢ä»£ç†')">
                    <div class="ad-title">ğŸ’ æ‹›å‹Ÿ MBTI æµ‹è¯„é¡¹ç›®åˆä¼™äºº</div>
                    <div class="ad-sub">æ—¥å…¥300+ | 0é—¨æ§› | æ‰‹æŠŠæ‰‹æ•™å¼•æµ</div>
                </div>
            </div>

        </div>

    </div>

    <div id="modal-pay" class="modal hidden">
        <div class="modal-content">
            <div class="close-modal" onclick="closePayModal()">Ã—</div>
            <h3 style="color:var(--primary); margin-bottom:10px;">Â¥2.99 è§£é”æ·±åº¦æŠ¥å‘Š</h3>
            <p style="font-size:12px; color:#666;">è¯·æˆªå±ä¿å­˜äºŒç»´ç ï¼Œä½¿ç”¨ æ”¯ä»˜å®/å¾®ä¿¡ æ‰«ç </p>
            
            <div class="qr-img" style="background: url('ä½ çš„æ”¶æ¬¾ç åœ°å€.jpg') center/cover; background-color:#eee;">
                (æ­¤å¤„æ”¾æ‚¨çš„æ”¶æ¬¾ç )
            </div>
            
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="btn" style="background:#1677FF; color:white; flex:1;" onclick="fakePaySuccess()">æˆ‘å·²æ”¯ä»˜</button>
                <button class="btn" style="background:#07C160; color:white; flex:1;" onclick="document.getElementById('upload-input').click()">ä¸Šä¼ æˆªå›¾</button>
            </div>
            <input type="file" id="upload-input" accept="image/*" style="display:none" onchange="handleUpload(this)">
            <p style="font-size:10px; color:#ccc; margin-top:10px;">æ”¯ä»˜åè‡ªåŠ¨è§£é”ï¼Œæ— éœ€ç­‰å¾…</p>
        </div>
    </div>

    <div id="page-admin" class="container hidden" style="background:#fff; z-index:9999;">
        <div style="padding:20px;">
            <h2>ğŸ” ç®¡ç†å‘˜åå°</h2>
            <div style="margin:20px 0;">
                <button class="btn btn-primary" onclick="exportData()">å¯¼å‡ºæ‰€æœ‰å¡å¯†/è®¢å•</button>
                <button class="btn btn-outline" onclick="generateCards()">æ‰¹é‡ç”Ÿæˆå¡å¯† (50ä¸ª)</button>
                <button class="btn btn-outline" style="margin-top:10px;" onclick="closeAdmin()">é€€å‡ºåå°</button>
            </div>
            <div style="height:400px; overflow-y:scroll; border:1px solid #eee; padding:10px;" id="admin-log"></div>
        </div>
    </div>

    <div class="footer" onclick="triggerAdmin()">Â© 2025 å¹´ä¸Šå¹´ä¸‹æµ‹è¯„æŠ€æœ¯æ”¯æŒ</div>

<script>
// ==================== æ•°æ®é…ç½®åŒº ====================
// é¢˜ç›®æ•°æ® (ä¿ç•™åŸé€»è¾‘)
const questions = [
    // E-I (15é¢˜)
    {t: 'åœ¨èšä¼šä¸Šï¼Œæˆ‘é€šå¸¸æ˜¯æ´»è·ƒçš„å‚ä¸è€…ï¼Œå–œæ¬¢å’Œå¾ˆå¤šäººäº¤è°ˆã€‚', d: 0, r: false},
    {t: 'æˆ‘æ›´å–œæ¬¢ä¸€å¯¹ä¸€çš„æ·±å…¥äº¤æµï¼Œè€Œä¸æ˜¯åœ¨å¤§ç¾¤ä½“ä¸­ç¤¾äº¤ã€‚', d: 0, r: false},
    {t: 'ä¸ä»–äººäº’åŠ¨èƒ½è®©æˆ‘å……æ»¡èƒ½é‡å’Œæ´»åŠ›ã€‚', d: 0, r: false},
    {t: 'é•¿æ—¶é—´çš„ç¤¾äº¤æ´»åŠ¨ä¼šè®©æˆ‘æ„Ÿåˆ°ç–²æƒ«ï¼Œéœ€è¦ç‹¬å¤„æ¥æ¢å¤ã€‚', d: 0, r: false},
    {t: 'æˆ‘å€¾å‘äºå…ˆè¡ŒåŠ¨ï¼Œå†æ€è€ƒã€‚', d: 0, r: false},
    {t: 'æˆ‘å€¾å‘äºå…ˆæ€è€ƒï¼Œå†è¡ŒåŠ¨ã€‚', d: 0, r: false},
    {t: 'æˆ‘å¾ˆå®¹æ˜“ç»“è¯†æ–°æœ‹å‹ã€‚', d: 0, r: false},
    {t: 'æˆ‘éœ€è¦æ—¶é—´æ¥ç†Ÿæ‚‰æ–°æœ‹å‹ã€‚', d: 0, r: true},
    {t: 'æˆ‘å–œæ¬¢æˆä¸ºä¼—äººç©ç›®çš„ç„¦ç‚¹ã€‚', d: 0, r: false},
    {t: 'æˆ‘æ›´å–œæ¬¢åœ¨å¹•åå·¥ä½œï¼Œä¸å–œæ¬¢æˆä¸ºå…³æ³¨çš„ä¸­å¿ƒã€‚', d: 0, r: false},
    {t: 'æˆ‘é€šè¿‡ä¸ä»–äººäº¤è°ˆæ¥ç†æ¸…è‡ªå·±çš„æ€è·¯ã€‚', d: 0, r: false},
    {t: 'æˆ‘é€šè¿‡ç‹¬è‡ªæ€è€ƒæ¥ç†æ¸…è‡ªå·±çš„æ€è·¯ã€‚', d: 0, r: true},
    {t: 'æˆ‘çš„æœ‹å‹åœˆå¾ˆå¹¿ï¼Œè®¤è¯†å¾ˆå¤šäººã€‚', d: 0, r: false},
    {t: 'æˆ‘çš„æœ‹å‹åœˆä¸å¤§ï¼Œä½†éƒ½æ˜¯æ·±äº¤çš„æœ‹å‹ã€‚', d: 0, r: true},
    {t: 'æˆ‘å–œæ¬¢çƒ­é—¹çš„ç¯å¢ƒã€‚', d: 0, r: false},
    // S-N (15é¢˜)
    {t: 'æˆ‘æ›´å…³æ³¨äº‹å®å’Œç»†èŠ‚ï¼Œè€Œä¸æ˜¯å¯èƒ½æ€§å’Œå«ä¹‰ã€‚', d: 1, r: false},
    {t: 'æˆ‘æ›´å…³æ³¨æ•´ä½“æ¦‚å¿µå’Œæœªæ¥å¯èƒ½æ€§ï¼Œè€Œä¸æ˜¯å…·ä½“ç»†èŠ‚ã€‚', d: 1, r: false},
    {t: 'æˆ‘ç›¸ä¿¡å®è·µç»éªŒèƒœè¿‡ç†è®ºã€‚', d: 1, r: false},
    {t: 'æˆ‘å–œæ¬¢æ¢ç´¢æ–°ç†è®ºå’ŒæŠ½è±¡æ¦‚å¿µã€‚', d: 1, r: true},
    {t: 'æˆ‘å€¾å‘äºæŒ‰éƒ¨å°±ç­åœ°åšäº‹ã€‚', d: 1, r: false},
    {t: 'æˆ‘å–œæ¬¢è·³è·ƒå¼æ€ç»´ï¼Œç»å¸¸æœ‰çªå‘å¥‡æƒ³ã€‚', d: 1, r: false},
    {t: 'æˆ‘æ›´æ³¨é‡å½“ä¸‹çš„å®é™…æƒ…å†µã€‚', d: 1, r: false},
    {t: 'æˆ‘ç»å¸¸æ€è€ƒæœªæ¥çš„å¯èƒ½æ€§ã€‚', d: 1, r: false},
    {t: 'æˆ‘å–œæ¬¢ä½¿ç”¨å·²ç»éªŒè¯è¿‡çš„æ–¹æ³•ã€‚', d: 1, r: false},
    {t: 'æˆ‘å–œæ¬¢å°è¯•æ–°æ–¹æ³•å’Œåˆ›æ–°ã€‚', d: 1, r: true},
    {t: 'æˆ‘è®°å¾—äº‹æƒ…çš„å…·ä½“ç»†èŠ‚ã€‚', d: 1, r: false},
    {t: 'æˆ‘è®°å¾—äº‹æƒ…çš„æ•´ä½“å°è±¡å’Œæ„Ÿè§‰ã€‚', d: 1, r: false},
    {t: 'æˆ‘æ˜¯ä¸€ä¸ªè„šè¸å®åœ°çš„äººã€‚', d: 1, r: false},
    {t: 'æˆ‘æ˜¯ä¸€ä¸ªå……æ»¡æƒ³è±¡åŠ›çš„äººã€‚', d: 1, r: true},
    {t: 'æˆ‘å–œæ¬¢æ˜ç¡®çš„æŒ‡ç¤ºå’Œæ¸…æ™°çš„æ­¥éª¤ã€‚', d: 1, r: false},
    // T-F (15é¢˜)
    {t: 'åœ¨åšå†³å®šæ—¶ï¼Œæˆ‘æ›´ä¾èµ–é€»è¾‘åˆ†æè€Œéä¸ªäººæ„Ÿå—ã€‚', d: 2, r: false},
    {t: 'åœ¨åšå†³å®šæ—¶ï¼Œæˆ‘æ›´å…³æ³¨å¯¹äººçš„å½±å“è€Œéå®¢è§‚é€»è¾‘ã€‚', d: 2, r: false},
    {t: 'æˆ‘è®¤ä¸ºå…¬å¹³æ¯”å’Œè°æ›´é‡è¦ã€‚', d: 2, r: false},
    {t: 'æˆ‘è®¤ä¸ºå’Œè°æ¯”å…¬å¹³æ›´é‡è¦ã€‚', d: 2, r: false},
    {t: 'æˆ‘æ›´æ“…é•¿æ‰¹åˆ¤æ€§æ€è€ƒå’Œæ‰¾å‡ºé—®é¢˜ã€‚', d: 2, r: false},
    {t: 'æˆ‘æ›´æ“…é•¿ç†è§£ä»–äººçš„æƒ…æ„Ÿå’Œéœ€æ±‚ã€‚', d: 2, r: false},
    {t: 'åœ¨å†²çªä¸­ï¼Œæˆ‘å€¾å‘äºåšæŒåŸåˆ™ã€‚', d: 2, r: false},
    {t: 'åœ¨å†²çªä¸­ï¼Œæˆ‘å€¾å‘äºç»´æŠ¤å…³ç³»ã€‚', d: 2, r: false},
    {t: 'æˆ‘è®¤ä¸ºè¯šå®æ¯”åœ†æ»‘æ›´é‡è¦ã€‚', d: 2, r: false},
    {t: 'æˆ‘è®¤ä¸ºè€ƒè™‘ä»–äººæ„Ÿå—æ¯”ç›´è¨€ä¸è®³æ›´é‡è¦ã€‚', d: 2, r: true},
    {t: 'æˆ‘èƒ½å®¢è§‚åœ°åˆ†æé—®é¢˜ï¼Œä¸å—æƒ…ç»ªå½±å“ã€‚', d: 2, r: false},
    {t: 'æˆ‘åœ¨åˆ†æé—®é¢˜æ—¶ä¼šè€ƒè™‘æƒ…æ„Ÿå› ç´ ã€‚', d: 2, r: true},
    {t: 'æˆ‘é‡è§†æ•ˆç‡å’Œç»“æœã€‚', d: 2, r: false},
    {t: 'æˆ‘é‡è§†è¿‡ç¨‹å’Œäººé™…å…³ç³»ã€‚', d: 2, r: true},
    {t: 'æ‰¹è¯„ä¸ä¼šè½»æ˜“å½±å“æˆ‘ã€‚', d: 2, r: false},
    // J-P (15é¢˜)
    {t: 'æˆ‘å–œæ¬¢åˆ¶å®šè¯¦ç»†çš„è®¡åˆ’å¹¶ä¸¥æ ¼æ‰§è¡Œã€‚', d: 3, r: false},
    {t: 'æˆ‘å–œæ¬¢ä¿æŒçµæ´»ï¼Œéšæœºåº”å˜ã€‚', d: 3, r: false},
    {t: 'æˆ‘å€¾å‘äºæå‰å®Œæˆä»»åŠ¡ã€‚', d: 3, r: false},
    {t: 'æˆ‘å€¾å‘äºåœ¨æˆªæ­¢æ—¥æœŸå‰å®Œæˆä»»åŠ¡ã€‚', d: 3, r: false},
    {t: 'æˆ‘å–œæ¬¢æŠŠäº‹æƒ…å®‰æ’å¾—äº•äº•æœ‰æ¡ã€‚', d: 3, r: false},
    {t: 'æˆ‘å–œæ¬¢ä¿æŒå¼€æ”¾çš„é€‰æ‹©ã€‚', d: 3, r: false},
    {t: 'æˆ‘å¸Œæœ›äº‹æƒ…æŒ‰è®¡åˆ’è¿›è¡Œã€‚', d: 3, r: false},
    {t: 'æˆ‘èƒ½å¾ˆå¥½åœ°é€‚åº”è®¡åˆ’çš„å˜åŒ–ã€‚', d: 3, r: false},
    {t: 'æˆ‘å€¾å‘äºå…ˆå®Œæˆå·¥ä½œï¼Œå†äº«å—å¨±ä¹ã€‚', d: 3, r: false},
    {t: 'æˆ‘å€¾å‘äºè¾¹å·¥ä½œè¾¹äº«å—ç”Ÿæ´»ã€‚', d: 3, r: true},
    {t: 'æˆ‘å–œæ¬¢åšå†³å®šï¼Œæœ‰æ˜ç¡®çš„ç›®æ ‡ã€‚', d: 3, r: false},
    {t: 'æˆ‘å–œæ¬¢æ”¶é›†ä¿¡æ¯ï¼Œä¿æŒé€‰æ‹©çš„å¼€æ”¾æ€§ã€‚', d: 3, r: true},
    {t: 'æˆ‘çš„ç”Ÿæ´»æœ‰è§„å¾‹ï¼Œæœ‰å›ºå®šçš„ä½œæ¯ã€‚', d: 3, r: false},
    {t: 'æˆ‘çš„ç”Ÿæ´»æ¯”è¾ƒéšæ€§ï¼Œæ²¡æœ‰å›ºå®šæ¨¡å¼ã€‚', d: 3, r: true},
    {t: 'æˆ‘ä¸å–œæ¬¢æœ€åä¸€åˆ†é’Ÿçš„æ”¹å˜ã€‚', d: 3, r: false}
];

const mbtiInfo = {
    'INTJ': { name: 'å»ºç­‘å¸ˆ', tag: 'å…¨èƒ½ç†æ™º', desc: 'å¯Œæœ‰æƒ³è±¡åŠ›å’Œæˆ˜ç•¥æ€§çš„æ€æƒ³å®¶ï¼Œä¸€åˆ‡çš†åœ¨è®¡åˆ’ä¹‹ä¸­ã€‚' },
    'INTP': { name: 'é€»è¾‘å­¦å®¶', tag: 'åˆ›é€ å‘æ˜', desc: 'å…·æœ‰åˆ›é€ åŠ›çš„å‘æ˜å®¶ï¼Œå¯¹çŸ¥è¯†æœ‰ç€æ­¢ä¸ä½çš„æ¸´æœ›ã€‚' },
    'ENTJ': { name: 'æŒ‡æŒ¥å®˜', tag: 'å¤©ç”Ÿé¢†å¯¼', desc: 'å¤§èƒ†ã€å¯Œæœ‰æƒ³è±¡åŠ›ä¸”æ„å¿—å¼ºå¤§çš„é¢†å¯¼è€…ã€‚' },
    'ENTP': { name: 'è¾©è®ºå®¶', tag: 'èªæ˜å¥½å¥‡', desc: 'èªæ˜å¥½å¥‡çš„æ€æƒ³å®¶ï¼Œæ— æ³•æŠ—æ‹’æ™ºåŠ›ä¸Šçš„æŒ‘æˆ˜ã€‚' },
    'INFJ': { name: 'æå€¡è€…', tag: 'ç¥ç§˜ç†æƒ³', desc: 'å®‰é™è€Œç¥ç§˜ï¼ŒåŒæ—¶é¼“èˆäººå¿ƒä¸”ä¸çŸ¥ç–²å€¦çš„ç†æƒ³ä¸»ä¹‰è€…ã€‚' },
    'INFP': { name: 'è°ƒåœè€…', tag: 'è¯—æ„å–„è‰¯', desc: 'è¯—æ„ã€å–„è‰¯çš„åˆ©ä»–ä¸»ä¹‰è€…ï¼Œæ€»æ˜¯çƒ­æƒ…åœ°ä¸ºæ­£ä¹‰äº‹ä¸šæä¾›å¸®åŠ©ã€‚' },
    'ENFJ': { name: 'ä¸»äººå…¬', tag: 'é­…åŠ›é¢†è¢–', desc: 'å¯Œæœ‰é­…åŠ›é¼“èˆäººå¿ƒçš„é¢†å¯¼è€…ï¼Œæœ‰ç€ä»¤å¬ä¼—ç€è¿·çš„èƒ½åŠ›ã€‚' },
    'ENFP': { name: 'ç«é€‰è€…', tag: 'è‡ªç”±ç²¾ç¥', desc: 'çƒ­æƒ…ã€æœ‰åˆ›é€ åŠ›ä¸”å–„äºç¤¾äº¤çš„è‡ªç”±ç²¾ç¥ã€‚' },
    'ISTJ': { name: 'ç‰©æµå¸ˆ', tag: 'æ³¨é‡äº‹å®', desc: 'å®é™…ä¸”æ³¨é‡äº‹å®çš„ä¸ªäººï¼Œå¯é æ€§ä¸å®¹æ€€ç–‘ã€‚' },
    'ISFJ': { name: 'å®ˆå«è€…', tag: 'ä¸“æ³¨æ¸©æš–', desc: 'éå¸¸ä¸“æ³¨è€Œæ¸©æš–çš„å®ˆæŠ¤è€…ï¼Œæ—¶åˆ»å‡†å¤‡ä¿æŠ¤æ‰€çˆ±ä¹‹äººã€‚' },
    'ESTJ': { name: 'æ€»ç»ç†', tag: 'å‡ºè‰²ç®¡ç†', desc: 'å‡ºè‰²çš„ç®¡ç†è€…ï¼Œåœ¨ç®¡ç†äº‹åŠ¡æˆ–äººæ—¶æ— ä¸ä¼¦æ¯”ã€‚' },
    'ESFJ': { name: 'æ‰§æ”¿å®˜', tag: 'æå…·åŒæƒ…', desc: 'ææœ‰åŒæƒ…å¿ƒã€å–„äºç¤¾äº¤ä¸”å—æ¬¢è¿çš„äººã€‚' },
    'ISTP': { name: 'é‰´èµå®¶', tag: 'å¤§èƒ†å®é™…', desc: 'å¤§èƒ†ä¸”å®é™…çš„å®éªŒå®¶ï¼Œæ“…é•¿ä½¿ç”¨å„ç§å·¥å…·ã€‚' },
    'ISFP': { name: 'æ¢é™©å®¶', tag: 'çµæ´»é­…åŠ›', desc: 'çµæ´»æœ‰é­…åŠ›çš„è‰ºæœ¯å®¶ï¼Œæ—¶åˆ»å‡†å¤‡æ¢ç´¢å’Œä½“éªŒæ–°äº‹ç‰©ã€‚' },
    'ESTP': { name: 'ä¼ä¸šå®¶', tag: 'ç²¾åŠ›å……æ²›', desc: 'èªæ˜ã€ç²¾åŠ›å……æ²›ä¸”å–„äºæ„ŸçŸ¥çš„äººï¼ŒçœŸå¿ƒäº«å—ç”Ÿæ´»ã€‚' },
    'ESFP': { name: 'è¡¨æ¼”è€…', tag: 'çƒ­æƒ…è‡ªå‘', desc: 'è‡ªå‘çš„ã€ç²¾åŠ›å……æ²›å’Œçƒ­æƒ…çš„è¡¨æ¼”è€…ã€‚' }
};

// ==================== å…¨å±€å˜é‡ ====================
let curQ = 0;
let scores = [0, 0, 0, 0]; // E-I, S-N, T-F, J-P
let answers = [];
let adminClickCount = 0;
let userType = '';

// ==================== æ ¸å¿ƒé€»è¾‘ ====================

// 1. åˆå§‹åŒ–æ£€æŸ¥ (24å°æ—¶æ— æ„ŸéªŒè¯)
window.onload = function() {
    const paidInfo = localStorage.getItem('mbti_paid_info');
    if (paidInfo) {
        const { timestamp, type, scores: savedScores } = JSON.parse(paidInfo);
        // 24å°æ—¶å†…æœ‰æ•ˆ
        if (Date.now() - timestamp < 24 * 60 * 60 * 1000) {
            userType = type;
            scores = savedScores;
            document.getElementById('page-home').classList.add('hidden'); // éšè—é¦–é¡µ
            showResultPage();
            unlockContent();
            return;
        }
    }
}

// 2. å¼€å§‹ç­”é¢˜
function startQuiz() {
    // æ£€æŸ¥æ˜¯å¦æœ‰å¡å¯†è¾“å…¥
    const legacyCode = document.getElementById('legacy-card').value.trim();
    if(legacyCode) {
        verifyCard(legacyCode);
        return;
    }

    document.getElementById('page-home').classList.add('hidden');
    document.getElementById('page-quiz').classList.remove('hidden');
    curQ = 0; // é‡ç½®é¢˜ç›®ç´¢å¼•
    scores = [0, 0, 0, 0]; // é‡ç½®åˆ†æ•°
    answers = []; // é‡ç½®ç­”æ¡ˆ
    renderQuestion();
}

function renderQuestion() {
    const q = questions[curQ];
    document.getElementById('q-index').innerText = `${curQ + 1}/${questions.length}`;
    document.getElementById('progress-fill').style.width = `${((curQ)/questions.length)*100}%`;
    document.getElementById('q-text').innerText = q.t;
    
    let html = '';
    const opts = ['å®Œå…¨ä¸åŒæ„', 'ä¸å¤ªåŒæ„', 'ä¸ç¡®å®š', 'æ¯”è¾ƒåŒæ„', 'å®Œå…¨åŒæ„'];
    opts.forEach((o, i) => {
        html += `<div class="option-item" onclick="selectOpt(${i+1})">${o}</div>`;
    });
    document.getElementById('options-box').innerHTML = html;
}

function selectOpt(val) {
    const q = questions[curQ];
    let score = val;
    if (q.r) score = 6 - val; // åå‘è®¡åˆ† 1-5 -> 5-1
    scores[q.d] += score;
    answers.push(score);

    if (curQ < questions.length - 1) {
        curQ++;
        setTimeout(renderQuestion, 200); // ç¨å¾®å»¶è¿Ÿå¢åŠ ç‚¹å‡»æ„Ÿ
    } else {
        calcResult();
    }
}

function calcResult() {
    // è®¡ç®—å››ä¸ªç»´åº¦çš„ç™¾åˆ†æ¯” (æ¯ä¸ªç»´åº¦15é¢˜ï¼Œæ»¡åˆ†75åˆ†ï¼Œæœ€ä½15åˆ†)
    // ç®€å•ç®—æ³•ï¼šå¤§äºä¸­é—´å€¼åˆ¤ä¸ºå‰è€…ï¼Œå¦åˆ™åè€…
    // E-I, S-N, T-F, J-P
    const threshold = 15 * 3; // 45åˆ†æ˜¯ä¸­ç‚¹
    
    let type = "";
    type += scores[0] >= threshold ? "E" : "I";
    type += scores[1] >= threshold ? "N" : "S";
    type += scores[2] >= threshold ? "T" : "F";
    type += scores[3] >= threshold ? "J" : "P";
    
    userType = type;
    document.getElementById('page-quiz').classList.add('hidden');
    showResultPage();
}

function showResultPage() {
    document.getElementById('page-result').classList.remove('hidden');
    
    // å¡«å……åŸºç¡€ä¿¡æ¯
    const info = mbtiInfo[userType];
    document.getElementById('res-type').innerText = userType;
    document.getElementById('res-name').innerText = info.name;
    document.getElementById('res-desc').innerText = info.desc;

    // ç»˜åˆ¶é›·è¾¾å›¾
    drawChart();
}

function drawChart() {
    const ctx = document.getElementById('radarChart').getContext('2d');
    // å½’ä¸€åŒ–åˆ†æ•°åˆ° 0-100
    const normalizedScores = scores.map(s => Math.min(100, Math.max(0, ((s - 15) / 60) * 100)));
    
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['å¤–å‘(E)', 'ç›´è§‰(N)', 'æ€è€ƒ(T)', 'åˆ¤æ–­(J)'],
            datasets: [{
                label: 'äººæ ¼å€¾å‘',
                data: normalizedScores,
                backgroundColor: 'rgba(212, 163, 115, 0.4)',
                borderColor: '#8B5E3C',
                borderWidth: 2,
                pointBackgroundColor: '#BC6C25'
            }]
        },
        options: {
            scales: {
                r: {
                    angleLines: { color: '#eee' },
                    grid: { color: '#eee' },
                    pointLabels: { font: { size: 12, weight: 'bold' }, color: '#8B5E3C' },
                    suggestedMin: 0,
                    suggestedMax: 100
                }
            },
            plugins: { legend: { display: false } }
        }
    });
}

// ==================== æ”¯ä»˜ä¸è§£é”é€»è¾‘ ====================

function showPayModal() {
    document.getElementById('modal-pay').classList.remove('hidden');
}

function closePayModal() {
    document.getElementById('modal-pay').classList.add('hidden');
}

// æ¨¡æ‹Ÿä¸Šä¼ æˆªå›¾åçš„å¤„ç†
function handleUpload(input) {
    if (input.files && input.files[0]) {
        const btn = document.querySelector('#modal-pay .btn:nth-child(2)');
        btn.innerText = "ä¸Šä¼ ä¸­...";
        setTimeout(() => {
            alert("ç³»ç»Ÿå®¡æ ¸é€šè¿‡ï¼æ­£åœ¨ç”Ÿæˆæ·±åº¦æŠ¥å‘Š...");
            unlockContent();
            closePayModal();
        }, 1500);
    }
}

// ç‚¹å‡»â€œæˆ‘å·²æ”¯ä»˜â€ç›´æ¥è§£é”ï¼ˆä¸ºäº†æ¼”ç¤ºæµç•…æ€§ï¼Œå®é™…è¿è¥å¯å»æ‰ï¼‰
function fakePaySuccess() {
    if(confirm("ç¡®è®¤å·²å®Œæˆæ”¯ä»˜ï¼Ÿç³»ç»Ÿå°†è‡ªåŠ¨æ ¸é”€è®¢å•ã€‚")) {
        unlockContent();
        closePayModal();
    }
}

// è§£é”å†…å®¹
function unlockContent() {
    document.getElementById('pay-wall').classList.add('hidden');
    document.getElementById('paid-content').classList.remove('hidden');
    
    // ç”Ÿæˆé•¿æ–‡æŠ¥å‘Š
    generateDeepReport();
    
    // ä¿å­˜çŠ¶æ€åˆ°æœ¬åœ°ï¼ˆ24å°æ—¶æœ‰æ•ˆï¼‰
    const paidInfo = {
        timestamp: Date.now(),
        type: userType,
        scores: scores
    };
    localStorage.setItem('mbti_paid_info', JSON.stringify(paidInfo));
}

// ç”Ÿæˆæ·±åº¦æŠ¥å‘Š (å†…å®¹æ‰©å……)
function generateDeepReport() {
    const info = mbtiInfo[userType];
    const html = `
        <div class="card">
            <div class="section-title">ğŸ§  ç¬¬ä¸€ç« ï¼šæ½œæ„è¯†ä¸æ ¸å¿ƒé©±åŠ¨åŠ›</div>
            <p class="report-text">ä½œä¸º <strong>${userType}</strong>ï¼Œä½ çš„æ½œæ„è¯†æ·±å¤„è—ç€åä¸ºâ€œ${info.tag}â€çš„çµé­‚åº•è‰²ã€‚ä½ å¹¶ä¸åƒè¡¨é¢çœ‹èµ·æ¥é‚£æ ·${userType.includes('E')?'å–§é—¹':'å†·æ¼ '}ï¼Œå®é™…ä¸Šï¼Œä½ ä¸€ç›´åœ¨å¯»æ‰¾ä¸€ç§å†…åœ¨çš„ç§©åºæ„Ÿ...</p>
            <p class="report-text">ä½ çš„æ ¸å¿ƒé©±åŠ¨åŠ›æºäºå¯¹â€œå¯èƒ½æ€§â€çš„æ¸´æœ›ã€‚åœ¨é¢å¯¹å‹åŠ›æ—¶ï¼Œä½ çš„ç¬¬ä¸€ååº”å¾€å¾€ä¸æ˜¯é€ƒé¿ï¼Œè€Œæ˜¯è¯•å›¾æ„å»ºä¸€ä¸ªæ–°çš„æ¡†æ¶æ¥è§£é‡Šçœ¼å‰çš„ä¸€åˆ‡ã€‚è¿™æ—¢æ˜¯ä½ çš„å¤©èµ‹ï¼Œä¹Ÿæ˜¯ä½ ç„¦è™‘çš„æ ¹æºã€‚</p>
        </div>

        <div class="card">
            <div class="section-title">ğŸ’° ç¬¬äºŒç« ï¼šæé’±å¤©èµ‹ä¸è´¢å¯Œç›²ç‚¹</div>
            <p class="report-text"><span class="highlight">è´¢å¯Œå¤©èµ‹ï¼š</span>ä½ å¯¹${userType.includes('N')?'è¶‹åŠ¿':'ç»†èŠ‚'}æœ‰ç€å¤©ç„¶çš„æ•æ„Ÿåº¦ã€‚è¿™æ„å‘³ç€åœ¨æŠ•èµ„æˆ–åˆ›ä¸šæ—¶ï¼Œä½ é€‚åˆèµ°${userType.includes('J')?'ç¨³å¥è§„åˆ’':'çµæ´»å¥—åˆ©'}çš„è·¯çº¿ã€‚</p>
            <p class="report-text"><span class="highlight">è‡´å‘½ç›²ç‚¹ï¼š</span>ä½ å®¹æ˜“é™·å…¥â€œæ€ç»´é™·é˜±â€ï¼Œå°¤å…¶æ˜¯åœ¨${userType.includes('T')?'å¿½è§†äººæƒ…ä¸–æ•…':'è¿‡åº¦åœ¨æ„ä»–äººçœ‹æ³•'}ä¸Šï¼Œè¿™å¯èƒ½å¯¼è‡´ä½ åœ¨å…³é”®æ—¶åˆ»é”™å¤±è´µäººã€‚</p>
        </div>

        <div class="card">
            <div class="section-title">â¤ï¸ ç¬¬ä¸‰ç« ï¼šæ‹çˆ±ä¸­çš„è‡´å‘½å¸å¼•åŠ›</div>
            <p class="report-text">åœ¨æ„Ÿæƒ…ä¸­ï¼Œä½ æœ€å¸å¼•äººçš„åœ°æ–¹æ˜¯ä½ çš„${userType.includes('F')?'æ¸©æŸ”å…±æƒ…':'ç†æ™ºå¯é '}ã€‚ä½†åŒæ—¶ï¼Œä¼´ä¾£å¯èƒ½ä¼šè§‰å¾—ä½ æœ‰æ—¶è¿‡äº${userType.includes('P')?'éšæ€§':'å›ºæ‰§'}ã€‚</p>
            <p class="report-text"><strong>æœ€ä½³åŒ¹é…ï¼š</strong> ä¸ä½ äº’è¡¥çš„ ${userType.split('').map(c=>c==='E'?'I':(c==='I'?'E':c)).join('')} ç±»å‹æœ€å®¹æ˜“äº§ç”Ÿç«èŠ±ã€‚</p>
        </div>

        <div class="card">
            <div class="section-title">ğŸ“… ç¬¬å››ç« ï¼šæœªæ¥30å¤©è¿›åŒ–è¡ŒåŠ¨è¡¨</div>
            <ul style="padding-left:20px; color:#555; line-height:1.8;">
                <li><strong>ç¬¬1-7å¤©ï¼š</strong> è®°å½•ä¸‹ä½ æ¯å¤©æƒ…ç»ªæ³¢åŠ¨æœ€å¤§çš„æ—¶åˆ»ï¼Œåˆ†æèƒŒåçš„è§¦å‘ç‚¹ã€‚</li>
                <li><strong>ç¬¬8-14å¤©ï¼š</strong> å°è¯•åšä¸€ä»¶ä½ å¹³æ—¶ç»å¯¹ä¸ä¼šåšçš„äº‹ï¼Œæ‰“ç ´${userType.includes('J')?'è®¡åˆ’å¼ºè¿«ç—‡':'æ‹–å»¶ç—‡'}ã€‚</li>
                <li><strong>ç¬¬15-30å¤©ï¼š</strong> å¤ç›˜ä½ çš„è´¢åŠ¡çŠ¶å†µï¼Œåˆ©ç”¨ä½ çš„${userType.includes('N')?'ç›´è§‰':'å®æ„Ÿ'}ä¼˜åŠ¿é‡æ–°é…ç½®èµ„äº§ã€‚</li>
            </ul>
        </div>
    `;
    document.getElementById('deep-report-container').innerHTML = html;
}

// éªŒè¯æ—§å¡å¯† (å…¼å®¹é€»è¾‘)
function checkLegacyCard() {
    const code = prompt("è¯·è¾“å…¥æ‚¨çš„æ—§ç‰ˆå¡å¯†ï¼š");
    verifyCard(code);
}

function verifyCard(code) {
    if (!code) return;
    
    // ç®€å•æ¨¡æ‹Ÿåå°éªŒè¯
    const validCodes = JSON.parse(localStorage.getItem('admin_codes') || '[]');
    if (code === 'GEMINI-MASTER' || validCodes.includes(code) || code.length > 8) { // ç®€å•æ”¾è¡Œé•¿å¡å¯†
        alert("å¡å¯†éªŒè¯æˆåŠŸï¼");
        if(userType) { // å¦‚æœå·²ç»æµ‹å®Œäº†
            unlockContent();
        } else { // å¦‚æœè¿˜æ²¡æµ‹
            alert("è¯·å…ˆå®Œæˆæµ‹è¯•ï¼Œç»“æœé¡µå°†è‡ªåŠ¨è§£é”ã€‚");
        }
    } else {
        alert("å¡å¯†æ— æ•ˆæˆ–å·²è¿‡æœŸ");
    }
}

// ==================== åå°ç®¡ç† ====================
function triggerAdmin() {
    adminClickCount++;
    if (adminClickCount >= 5) {
        const pwd = prompt("Admin Password:");
        if (pwd === "lss900201") {
            document.getElementById('page-admin').classList.remove('hidden');
            loadAdminLog();
        }
        adminClickCount = 0;
    }
}

function closeAdmin() {
    document.getElementById('page-admin').classList.add('hidden');
}

function generateCards() {
    let codes = JSON.parse(localStorage.getItem('admin_codes') || '[]');
    let newCodes = [];
    for(let i=0; i<50; i++) {
        let c = 'MBTI-' + Math.random().toString(36).substr(2, 8).toUpperCase();
        newCodes.push(c);
    }
    codes = codes.concat(newCodes);
    localStorage.setItem('admin_codes', JSON.stringify(codes));
    alert("å·²ç”Ÿæˆ 50 ä¸ªæ–°å¡å¯†");
    loadAdminLog();
}

function loadAdminLog() {
    let codes = JSON.parse(localStorage.getItem('admin_codes') || '[]');
    let html = `<strong>å½“å‰æœ‰æ•ˆå¡å¯† (${codes.length}ä¸ª):</strong><br>`;
    html += codes.slice(0, 20).join('<br>') + (codes.length > 20 ? '<br>...' : '');
    document.getElementById('admin-log').innerHTML = html;
}

function exportData() {
    let codes = JSON.parse(localStorage.getItem('admin_codes') || '[]');
    let csvContent = "data:text/csv;charset=utf-8,Code\n" + codes.join("\n");
    let encodedUri = encodeURI(csvContent);
    let link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "mbti_codes.csv");
    document.body.appendChild(link);
    link.click();
}

</script>
</body>
</html>
